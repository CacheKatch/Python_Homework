# Set up required libraries
from pathlib import Path
import csv

# Initialize lists
records = []

newdb_hdr = ["date", "prior pnl"]

# set up the file extraction path . Resources folder has been copied inside this repository
filepath = Path("Resources/dummydb.csv")

with open(filepath,"r") as csvfile: # from this DB we extract date and prior month 
    #print(csv.reader(csvfile))
    #print(type(csvfile))
    csvreader = csv.reader(csvfile,delimiter=",")
    #print(type(csvreader))

    nxt_12 = next(csvreader) # we are skipping one row on this step(header)

    date = ""
    prior_pnl = 0

    for item in csvreader:  
        date = row[0]
        item.append(date)
        prior_pnl = int(item[1])
        item.append(prior_pnl)
        #print(date)

        records.append(item)

    #print(records)


newdb_hdr.append("current_pnl")
filepath2 = Path("Resources/budget_data.csv")

with open(filepath2,"r") as csvfile:
    csvreader = csv.reader(csvfile,delimiter=",")
    nxt_22 = next(csvreader)
    nxt_23 = next(csvreader)
    nxt_24 = next(csvreader)

    for item in csvreader:
        current_pnl = int(item[1])
        item.append(current_pnl)
        records.append(item)

    
print(records)

my_outputpath = Path('output4.csv')

with open(my_outputpath, 'w') as csvfile:
    csvwriter = csv.writer(csvfile)
    csvwriter.writerow(newdb_hdr)
    for colu in records:
        csvwriter.writerow(colu)
